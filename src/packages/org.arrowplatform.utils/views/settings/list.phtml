<ul class="breadcrumb">
    <li><a href="./admin"><i class="icon-home"></i>Dashboard</a> <span class="divider">/</span></li>
    <li class="active">Ustawienia aplikacji</li>
</ul>

<div style="padding: 10px;">
    <a class="btn " id="save-settings" href="#" rel="tooltip" data-loading-text="Zapisuje..."  data-original-title="Zapusuje wszystkie ustawienia"><i class="icon-ok-circle"></i>zapisz wszystkie ustawienia</a>




</div>
<? if($request["saved"]){?>
<div style="padding: 10px;">
    <div class="alert alert-success">
        <button type="button" class="close" data-dismiss="alert">×</button>
        <strong>Dobra robota!</strong> Właśnie ustawiłeś nowe zmienne aplikacji.
    </div>
</div>
<? }?>

<form id="conf-form" action="o:utils::/settings/save_settings,v:./list?saved=1" enctype="multipart/form-data" method="post">
    <div id="conf-container" style="width: 95%; padding: 10px;;">
        <? $currentSection = "" ?>
        <?foreach ($this["config"] as $package => $settings) { ?>
        <h1 ><?=$this["packages"][$package]["name"]?></h1>
            <hr />
        <div style="padding:0;">
            <table>
                <?foreach ($settings as $setting) { if(!$setting["editable"]){continue;} ?>
                <?if($currentSection!=$setting["section"]){?>
                    <? $currentSection = $setting["section"] ?>
                    <tr>
                        <td><legend><?=$setting["section"]?></legend></td>
                    </tr>
                <?}?>
                <tr>
                    <td style="width: 400px; padding-left: 45px;">
                        <label for="<?=$setting["package"]?><?=$setting["name"]?>"><?=$setting["title"]?$setting["title"]:$setting["name"]?>  </label>
                        <div style="font-size: 10px; color: grey;"><?=$setting["description"]?></div>
                    </td>
                    <td>
                        <?if ($setting["type"] == "array") { ?>
                        <? foreach ($setting["options"] as $key => $item) { ?>
                            <input  type="checkbox" name="data[<?=$setting["package"]?>][<?=$setting["name"]?>][]" value="<?=$key?>"> <?= $item ?><br/>
                            <? } ?>
                        <? } elseif ($setting["type"] == "set") { ?>
                        <select name="data[<?=$setting["package"]?>][<?=$setting["name"]?>]" id="<?=$setting["package"]?><?=$setting["name"]?>">
                            <? foreach ($setting["options"] as $key => $item) { ?>
                            <option value="<?=$key?>" <?if ($setting["value"] == $key) { ?>selected="selected" <? }?> > <?=$item ?></option>
                            <? } ?>
                        </select>
                        <? } elseif ($setting["type"] == "file") { ?>
                            <? $id = $setting["value"] ?>

                            <input type="file" name="data[<?=$setting["package"]?>][<?=$setting["name"]?>]" />
                            <?if($setting["value"]){?>

                                <?if( \Arrow\Package\Media\Element::isImageFile($setting["value"]) ){?>
                                <? } ?>
                                <div style="padding: 5px;;">
                                    <img src="<?=$setting["value"]?>" style="max-height: 100px; max-width: 100px; float: left; margin-right: 5px;;" />
                                    <a href="<?=$setting["value"]?>" target="_blank"><b>pobierz plik</b></a><br /><br />
                                    <input id="<?=$setting["package"]?><?=$setting["name"]?>" type="checkbox" name="data[<?=$setting["package"]?>][<?=$setting["name"]?>]" value="">
                                    <label for="<?=$setting["package"]?><?=$setting["name"]?>">Usuń plik</label>
                                </div>
                            <? } ?>
                        <? } else { ?>
                        <input id="<?=$setting["package"]?><?=$setting["name"]?>" name="data[<?=$setting["package"]?>][<?=$setting["name"]?>]" type="text" value="<?=$setting["value"]?>"    class="form-control" style="width:300px;" />

                        <? }?>
                    </td>
                </tr>

                <? }?>
                <tr>
                    <td colspan="2" align="center"><a href="#" class="conf-save">Zapisz</a></td>
                </tr>
            </table>
        </div>

        <? }?>

</form>
</div>



<script type="text/javascript">
    $("#save-settings,.conf-save").click(function (e) {
        e.preventDefault();
        $("#conf-form").submit();
    });
</script>
