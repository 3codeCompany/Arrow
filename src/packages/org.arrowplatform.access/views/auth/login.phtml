<!doctype html>
<html style="height: 100%;">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Web Application</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">



    <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
    <link href="http://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">
    <!-- Needs images, font... therefore can not be part of main.css -->
    <link rel="stylesheet" href="<?=$this["layoutPath"]?>bower_components/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="<?=$this["layoutPath"]?>bower_components/weather-icons/css/weather-icons.min.css">
    <!-- end Needs images -->

    <link rel="stylesheet" href="<?=$this["layoutPath"]?>styles/main.css">

</head>
<body data-ng-app="app" style="height: 100%;" id="app" class="app" data-custom-page="" data-off-canvas-nav="" data-ng-controller="AppCtrl" data-ng-class=" {'layout-boxed': admin.layout === 'boxed' } ">
<!--[if lt IE 9]>
<p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
<![endif]-->

<?
    $form = $this["form"];
    $tmp = file_get_contents("http://www.bing.com/HPImageArchive.aspx?format=js&idx=0&n=1&mkt=en-US");
    $tmp = json_decode($tmp,true);

?>
<div class="main-container" style="height: 100%;">
    <section   id="content" class="content-container animate-fade-up" autoscroll="1" style="margin-left: 0; height: 100%; transition: 0.1; background-image: url(//www.bing.com/<?=$tmp["images"][0]["url"]?>); background-position: center center;">
        <div class="page-signin" style=" background-color: rgba(240,240,240,0.9);  width: 500px; margin: 100px auto; border: solid 1px grey;  border-radius: 10px; 	position:relative;
    -webkit-box-shadow:0 1px 4px rgba(0, 0, 0, 0.3), 0 0 40px rgba(0, 0, 0, 0.1) inset;
       -moz-box-shadow:0 1px 4px rgba(0, 0, 0, 0.3), 0 0 40px rgba(0, 0, 0, 0.1) inset;
            box-shadow:0 1px 4px rgba(0, 0, 0, 0.3), 0 0 40px rgba(0, 0, 0, 0.1) inset;
">

            <div class="signin-header" style="margin: 0;">
                <section class="logo text-center">
                    <a href="#/"><?=\Arrow\Models\Settings::getDefault()->getSetting("application.panel.title")?></a>
                </section>
            </div>

            <div class="signin-body" style="border: 0">
                <div class="">
                    <div class="form-container">

                        <?= $form->getHeader() ?>
                            <fieldset>
                                <div class="form-group">
                                    <span class="glyphicon glyphicon-envelope"></span>
                                    <input type="text"
                                           class="form-control input-lg input-round text-center"
                                           placeholder="Twój login"
                                           name="data[login]" style="border-radius: 0; padding-top: 0; padding-bottom: 0;"
                                        >
                                </div>
                                <div class="form-group">
                                    <span class="glyphicon glyphicon-lock"></span>
                                    <input type="password"
                                           class="form-control input-lg input-round text-center"
                                           placeholder="Hasło"
                                           name="data[password]" style="border-radius: 0; padding-top: 0; padding-bottom: 0;"
                                        >
                                </div>

                                <div class="form-group">
                                    <button  type="submit" class="btn btn-primary btn-lg btn-round btn-block text-center" style="border-radius: 0">Zaloguj się do systemu</button>
                                </div>
                               <!-- <div class="checkbox" style="margin-left: 150px;">
                                    <label>
                                        <input type="checkbox" name="remember_me"> Zapamiętaj mnie
                                    </label>
                                </div>-->
                            </fieldset>
                        <input id="auth-from" type="hidden" name="from" value="<?=$request["from"]?>" />
                        <?= $form->getFooter() ?>

                        <section style="display: none;">
                            <p class="text-center"><a href="#/pages/forgot-password">Zapomniałeś hasła?</a></p>
                            <!--<p class="text-center text-muted text-small">Don't have an account yet? <a href="#/pages/signup">Sign up</a></p>-->
                        </section>

                    </div>
                </div>
            </div>

        </div>
    </section>
</div>


<script src="<?=$this["layoutPath"]?>scripts/vendor.js"></script>
<script src="<?=$this["layoutPath"]?>scripts/ui.js"></script>


<script src="http://code.highcharts.com/highcharts.js"></script>

<link rel="stylesheet" href="r:common::/js/select2/select2.css"/>
<script src="r:common::/js/select2/select2.min.js" type="text/javascript"></script>
<link rel="stylesheet" href="r:common::/js/alertify/alertify.core.css" />
<link rel="stylesheet" href="r:common::/js/alertify/alertify.bootstrap.css" />
<script src="r:common::/js/alertify/alertify.min.js"></script>

<?
$relative = str_replace(ARROW_DOCUMENTS_ROOT,"",ARROW_LIBS_PATH);
$pathCss = "controls/resources/controls-api.css";
$pathScript = "controls/resources/controls-api.js";
$pathCss = $relative."/".$pathCss."?".filemtime( ARROW_LIBS_PATH."/".$pathCss );
$pathScript = $relative."/".$pathScript."?".filemtime( ARROW_LIBS_PATH."/".$pathScript );
?>
<link rel="stylesheet" type="text/css" href="<?=$pathCss?>"/>
<script src="<?=$pathScript?>"></script>

<style>
    body{
        color: #333;
    }
    /* line 294, C:\dev\www\arrowplatform\src\packages\org.arrowplatform.common\resources\styles\less\mods\ui-mod.less */
    .form-field-error-text{
        color: red;
        font-weight: bold;
    }
    .navbar{
        margin-bottom: 5px;;
    }

    .navbar-form .form-field-error-text {
        top: -30px !important;
        left: 20px !important;
        border-radius: 4px;
        border-left: solid 2px;
    }
    /* line 299, C:\dev\www\arrowplatform\src\packages\org.arrowplatform.common\resources\styles\less\mods\ui-mod.less */
    .navbar-form .form-field-error-text:before,
    .navbar-form .form-field-error-text:after {
        display: none;
    }
    .w-uploader{
        min-height: 35px;;
    }
    .w-textfilter-body .serenity-widget{
        display: inline-block;

    }
    .select2-container .select2-choice {
        height: 33px;
        padding-top: 3px;
    }
    .navbar-collapse{
        padding-left: 0px;
    }
    * { padding: 0; margin: 0; }
    html, body, #fullheight {
        min-height: 100% !important;
        height: 100%;
    }

</style>




<script type="text/javascript">
    // Using YQL and JSONP
    $.ajax({
        url: "//www.bing.com/HPImageArchive.aspx?format=js&idx=0&n=1&mkt=en-US",
        // The name of the callback parameter, as specified by the YQL service
        jsonp : false,
        // Tell jQuery we're expecting JSONP
        dataType: "jsonp",
        // Tell YQL what we want and that we want JSON


        // Work with the response
        success: function( response ) {
            console.log( response ); // server response
        }
    });


var select2 = function(el){
    $("select",el).each(function (index, el) {
        if($(el).is(".no-select2")) return;

        $(el).addClass(".no-select2").select2({
            minimumResultsForSearch: 10,
            disable_search: ($(el).find("option").length < 15),
            dropdownAutoWidth: true,
            adaptContainerCssClass: function(clazz){
                if(clazz != "form-control")
                    return clazz;
            }
        });
    });
};

window.Serenity.scanForWidgets();




var ctrlFormCallbacks = {

    beforeSerialize: function (form) {
        el = $("[type='submit']", form);

        if (form.parent().is(".modal-body")) {
            el = form.parent().next().find(".btn-primary");
        }
        var text = el.text();
        el.html(text + '<i class="fa fa-spinner submit-indicator fa-spin"></i> ').attr('disabled', 'disabled');

    },
    clearCommunicates: function (form) {
        form.find(".form-field-error-text", form).remove();
        form.find(".form-error-text", form).parents(".control-group:eq(0)").remove();
        form.find(".error").removeClass("error");
        var indicator = form.find(".submit-indicator");
        indicator.parent().removeAttr("disabled");
        indicator.remove()

        if (form.parent().is(".modal-body")) {
            var indicator = form.parent().next().find(".submit-indicator");
            indicator.parent().removeAttr("disabled");
            indicator.remove()
        }
    },
    fieldError: function (input, errors, form) {


        if(input.length == 0 ){

            ctrlFormCallbacks.formError(form,errors)
            return;
        }

        var str = "";
        for (var i = 0; i < errors.length; i++) {
            str += (i == 0 ? "" : ", ") + errors[i];
        }
        var ctrls = input.parents(".controls")

        ctrls.parent().addClass("error");
        var error = $('<div class="form-field-error-text"><i class="fa fa-exclamation-triangle"></i> ' + str + '</div>');
        //in no bootstrap form
        if (ctrls.length == 0 || ctrls.is(".form-inline")) {
            //error.addClass("alert-error").css({padding: '4px'});

            if (input.parent().is(".input-append") || input.parent().is(".input-prepend")) {
                error.insertAfter(input.parent());

            } else {
                error.insertAfter(input);
                error.css({'left': input.width() + 40, 'white-space': 'nowrap'})
                //error.mouseleave(function(){ error.fadeOut() })
                input.focus(function(){ error.fadeOut() });
            }
        } else {

            //
            if (input.parent().is(".input-append") || input.parent().is(".input-prepend")) {
                error.insertAfter(input.parent());
            } else if (input.parent().is(".btn")) {
                error.insertAfter(input.parent());
            } else {
                error.insertAfter(input);
            }
        }
    },
    formError: function (form, errors) {
        form.find(">.alert").remove()
        //alert form.length;
        if ( errors && errors.length)
            form.prepend($('<div class="alert alert-danger"><i class="fa fa-exclamation-triangle"></i> ' + errors.join(",") + '</div>'));
    },
    success: function (successCommunicate, response, form) {
        form.find(">.alert").remove()
        if (successCommunicate.length) {
            text = successCommunicate.html();
            text = text.replace(/\{(.+?)\}/g, function (match, contents, offset, s) {
                    return response[contents];
                }
            );
            successCommunicate.html(text);
            successCommunicate.show().removeClass("hidden");
            form.hide();
            if (form.parent().is(".modal-body")) {
                form.parent().next().find(".btn-primary").hide();
            }
        }
    }
}

</script>
</body>
</html>